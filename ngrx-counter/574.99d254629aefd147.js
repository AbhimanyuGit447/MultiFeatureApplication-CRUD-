"use strict";(self.webpackChunkngrx_counter=self.webpackChunkngrx_counter||[]).push([[574],{7574:(R,g,c)=>{c.r(g),c.d(g,{PostModule:()=>B});var m=c(6019),r=c(7537),a=c(4742),d=c(1400),i=c(3139);const h=(0,i.PH)("[posts page] add post",(0,i.Ky)()),Z=(0,i.PH)("[posts page] add post success",(0,i.Ky)()),f=(0,i.PH)("[posts page] update post",(0,i.Ky)()),P=(0,i.PH)("[posts page] update post success",(0,i.Ky)()),T=(0,i.PH)("[posts page] delete post",(0,i.Ky)()),A=(0,i.PH)("[posts page] delete post success",(0,i.Ky)()),v=(0,i.PH)("[posts page] load posts"),b=(0,i.PH)("[posts page] load post success",(0,i.Ky)());var t=c(3668);let I=(()=>{class o{constructor(s){this.store=s}ngOnInit(){this.postForm=new r.cw({title:new r.NI(null,[r.kI.required,r.kI.minLength(6)]),description:new r.NI(null,[r.kI.required,r.kI.minLength(10)])})}onAddPost(){this.postForm.valid&&this.store.dispatch(h({post:{title:this.postForm.value.title,description:this.postForm.value.description}}))}showDescriptionErrors(){const s=this.postForm.get("description");if((null==s?void 0:s.touched)&&!s.valid){if(s.errors.required)return"Description is required";if(s.errors.minLength(5))return"Description should have minimum 10 words"}}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(i.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-post"]],outputs:{showDescriptionErrors:"showDescriptionErrors"},decls:19,vars:3,consts:[[1,"row","my-4"],[1,"col-md-12"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["type","text","formControlName","title",1,"form-control"],["formControlName","description",1,"form-control"],[1,"my-3"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(s,e){1&s&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._uU(3," Add Post "),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"form",2),t.NdJ("ngSubmit",function(){return e.onAddPost()}),t.TgZ(6,"div",3),t.TgZ(7,"label"),t._uU(8,"Title"),t.qZA(),t._UZ(9,"input",4),t.qZA(),t.TgZ(10,"div",3),t.TgZ(11,"label"),t._uU(12,"Description"),t.qZA(),t._UZ(13,"textarea",5),t.TgZ(14,"div"),t._uU(15),t.qZA(),t.qZA(),t.TgZ(16,"div",6),t.TgZ(17,"button",7),t._uU(18," Add Post "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&s&&(t.xp6(5),t.Q6J("formGroup",e.postForm),t.xp6(10),t.Oqu(e.showDescriptionErrors()),t.xp6(2),t.Q6J("disabled",!e.postForm.valid))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u],styles:[""]}),o})();const S="posts",y=(0,i.ZF)(S),w=(0,i.P1)(y,o=>o.posts),N=(0,i.P1)(y,(o,n)=>o.posts.find(s=>s.id===n.id));let J=(()=>{class o{constructor(s,e,p){this.route=s,this.store=e,this.router=p}ngOnInit(){this.route.paramMap.subscribe(s=>{const e=s.get("id");this.postSubscription=this.store.select(N,{id:e}).subscribe(p=>{console.log("I am "+p+this.post),this.post=p,this.createForm()})})}createForm(){var s,e;this.postForm=new r.cw({title:new r.NI(null===(s=this.post)||void 0===s?void 0:s.title,[r.kI.required,r.kI.minLength(6)]),description:new r.NI(null===(e=this.post)||void 0===e?void 0:e.description,[r.kI.required,r.kI.minLength(10)])})}ngOnDestroy(){this.postSubscription&&this.postSubscription.unsubscribe()}onSubmit(){var s;if(!this.postForm.valid)return;const u={id:null===(s=this.post)||void 0===s?void 0:s.id,title:this.postForm.value.title,description:this.postForm.value.description};this.store.dispatch(f({post:u})),this.router.navigate(["posts"])}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(a.gz),t.Y36(i.yh),t.Y36(a.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-post"]],decls:17,vars:1,consts:[[1,"row"],[1,"col-md-12"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["type","text","formControlName","title",1,"form-control"],["formControlName","description",1,"form-control"],[1,"my-3"],["type","submit",1,"btn","btn-primary"]],template:function(s,e){1&s&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._uU(3," Update Post "),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"form",2),t.NdJ("ngSubmit",function(){return e.onSubmit()}),t.TgZ(6,"div",3),t.TgZ(7,"label"),t._uU(8,"Title"),t.qZA(),t._UZ(9,"input",4),t.qZA(),t.TgZ(10,"div",3),t.TgZ(11,"label"),t._uU(12,"Description"),t.qZA(),t._UZ(13,"textarea",5),t.qZA(),t.TgZ(14,"div",6),t.TgZ(15,"button",7),t._uU(16," Save Post "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&s&&(t.xp6(5),t.Q6J("formGroup",e.postForm))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u],styles:[""]}),o})();const $=function(o){return["edit",o]};function k(o,n){if(1&o){const s=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.TgZ(8,"a",6),t._uU(9,"Update"),t.qZA(),t.TgZ(10,"button",7),t.NdJ("click",function(){const u=t.CHM(s).$implicit;return t.oxw().onDeletePost(u.id)}),t._uU(11,"Delete"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const s=n.$implicit;t.xp6(2),t.hij(" ",s.id," "),t.xp6(2),t.hij(" ",s.title," "),t.xp6(2),t.hij(" ",s.description," "),t.xp6(2),t.Q6J("routerLink",t.VKq(4,$,s.id))}}const G=function(){return["/posts/add"]};let M=(()=>{class o{constructor(s){this.store=s}ngOnInit(){this.posts=this.store.select(w),this.store.dispatch(v())}onDeletePost(s){confirm("Are you sure you want to delete? ")&&this.store.dispatch(T({id:s}))}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(i.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-list"]],decls:23,vars:5,consts:[[1,"row"],[1,"col-md-8"],["href","#",1,"btn","btn-primary",3,"routerLink"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"col-md-4"],["href","",1,"btn","btn-primary",3,"routerLink"],[1,"btn","btn-danger",2,"margin-left","10px","margin-top","auto",3,"click"]],template:function(s,e){1&s&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._uU(3," Post List "),t.qZA(),t.TgZ(4,"div"),t.TgZ(5,"a",2),t._uU(6,"Add Post"),t.qZA(),t.qZA(),t.TgZ(7,"table",3),t.TgZ(8,"thead"),t.TgZ(9,"tr"),t.TgZ(10,"th"),t._uU(11," Id "),t.qZA(),t.TgZ(12,"th"),t._uU(13," Title "),t.qZA(),t.TgZ(14,"th"),t._uU(15," Description "),t.qZA(),t.TgZ(16,"th"),t._uU(17," Actions "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,k,12,6,"tr",4),t.ALo(20,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"div",5),t._UZ(22,"router-outlet"),t.qZA(),t.qZA()),2&s&&(t.xp6(5),t.Q6J("routerLink",t.DdM(4,G)),t.xp6(14),t.Q6J("ngForOf",t.lcZ(20,2,e.posts)))},directives:[a.yS,m.sg,a.lC],pipes:[m.Ov],styles:[""]}),o})();var U=c(5724),l=c(4753),q=c(3067),Y=c(4522);let H=(()=>{class o{constructor(s){this.http=s}getPosts(){return this.http.get("https://ngrx-stateapp-default-rtdb.firebaseio.com/posts.json").pipe((0,l.U)(s=>{const e=[];for(let p in s)e.push(Object.assign(Object.assign({},s[p]),{id:p}));return e}))}addPost(s){return this.http.post("https://ngrx-stateapp-default-rtdb.firebaseio.com/posts.json",s)}updatePost(s){return this.http.patch("https://ngrx-stateapp-default-rtdb.firebaseio.com/posts.json",{[s.id]:{title:s.title,description:s.description}})}deletePost(s){return this.http.delete(`https://ngrx-stateapp-default-rtdb.firebaseio.com/posts/${s}.json`)}}return o.\u0275fac=function(s){return new(s||o)(t.LFG(Y.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),K=(()=>{class o{constructor(s,e){this.actions$=s,this.postsService=e,this.loadPosts$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(v),(0,U.z)(p=>this.postsService.getPosts().pipe((0,l.U)(u=>b({posts:u})))))),this.addPost$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(h),(0,U.z)(p=>this.postsService.addPost(p.post).pipe((0,l.U)(u=>{const C=Object.assign(Object.assign({},p.post),{id:u.name});return Z({post:C})}))))),this.updatePost$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(f),(0,q.w)(p=>this.postsService.updatePost(p.post).pipe((0,l.U)(u=>P({post:p.post})))))),this.deletePost$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(T),(0,q.w)(p=>this.postsService.deletePost(p.id).pipe((0,l.U)(u=>A({id:p.id}))))))}}return o.\u0275fac=function(s){return new(s||o)(t.LFG(d.eX),t.LFG(H))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();const Q=(0,i.Lq)({posts:[]},(0,i.on)(Z,(o,n)=>{let s=Object.assign({},n.post);return Object.assign(Object.assign({},o),{posts:[...o.posts,s]})}),(0,i.on)(P,(o,n)=>{const s=o.posts.map(e=>n.post.id===e.id?n.post:e);return Object.assign(Object.assign({},o),{posts:s})}),(0,i.on)(A,(o,{id:n})=>{const s=o.posts.filter(e=>e.id!==n);return Object.assign(Object.assign({},o),{posts:s})}),(0,i.on)(b,(o,n)=>Object.assign(Object.assign({},o),{posts:n.posts})));function X(o,n){return Q(o,n)}const W=[{path:"",component:M,children:[{path:"add",component:I},{path:"edit/:id",component:J}]}];let B=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.ez,r.UX,a.Bz.forChild(W),i.Aw.forFeature(S,X),d.sQ.forFeature([K])]]}),o})()}}]);